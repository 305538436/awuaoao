import{_ as I}from"./preload-helper.41c905a7.js";import{h as V,ap as x,aq as E,aH as P,ar as v,K as B,a as f,b as D,J as _,o as S,a4 as M,w as O,a9 as U,j as l,k as b,D as i,x as c,T as d,u as s,v as w,y as R,E as y,z as j,aI as q}from"./vue.543fafcc.js";import{u as z}from"./keepAliveNames.cf66da55.js";import{u as H}from"./themeConfig.4c307989.js";import{S as J}from"./storage.542a95ff.js";import{e as K}from"./mitt.7f99bbc0.js";const F={class:"layout-parent"},G=V({name:"layoutParentView"}),ae=V({...G,setup(Q){const g=x(()=>I(()=>import("./iframes.b4a6ca17.js"),["./iframes.b4a6ca17.js","./vue.543fafcc.js"],import.meta.url)),o=E(),A=P(),T=z(),k=H(),{keepAliveNames:n,cachedViews:p}=v(T),{themeConfig:m}=v(k),e=B({refreshRouterViewKey:"",iframeRefreshKey:"",keepAliveNameList:[],iframeList:[]}),u=f(()=>m.value.animation),L=f(()=>m.value.isTagsview?p.value:e.keepAliveNameList),h=f(()=>o.meta.isIframe),N=async()=>{A.getRoutes().forEach(a=>{a.meta.isIframe&&(a.meta.isIframeOpen=!1,a.meta.loading=!0,e.iframeList.push({...a}))})};return D(()=>{e.keepAliveNameList=n.value,K.on("onTagsViewRefreshRouterView",a=>{e.keepAliveNameList=n.value.filter(t=>o.name!==t),e.refreshRouterViewKey="",e.iframeRefreshKey="",_(()=>{e.refreshRouterViewKey=a,e.iframeRefreshKey=a,e.keepAliveNameList=n.value})})}),S(()=>{N(),_(()=>{setTimeout(()=>{if(m.value.isCacheTagsView){let a=J.get("tagsViewList")||[];p.value=a.filter(t=>{var r;return(r=t.meta)==null?void 0:r.isKeepAlive}).map(t=>t.name)}},0)})}),M(()=>{K.off("onTagsViewRefreshRouterView",()=>{})}),O(()=>o.fullPath,()=>{e.refreshRouterViewKey=decodeURI(o.fullPath)},{immediate:!0}),(a,t)=>{const r=U("router-view");return l(),b("div",F,[i(r,null,{default:c(({Component:C})=>[i(d,{name:s(u),mode:"out-in"},{default:c(()=>[(l(),w(q,{include:s(L)},[R((l(),w(j(C),{key:e.refreshRouterViewKey,class:"w100"})),[[y,!s(h)]])],1032,["include"]))]),_:2},1032,["name"])]),_:1}),i(d,{name:s(u),mode:"out-in"},{default:c(()=>[R(i(s(g),{class:"w100",refreshKey:e.iframeRefreshKey,name:s(u),list:e.iframeList},null,8,["refreshKey","name","list"]),[[y,s(h)]])]),_:1},8,["name"])])}}});export{ae as default};
